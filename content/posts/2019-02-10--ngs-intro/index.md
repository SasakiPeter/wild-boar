---
title: æ¬¡ä¸–ä»£ã‚·ãƒ¼ã‚±ãƒ³ã‚µãƒ¼ã«ã¤ã„ã¦èª¿æŸ»
category: "bio-infomatics"
cover: dna.jpg
author: sasaki peter
---

NGSã«ã¤ã„ã¦å‹‰å¼·ã—ãŸã¨ãã®æ®‹éª¸ã€‚

## ç¬¬ä¸€å›

### Windowsä¸Šã§Ubuntuç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹

#### ä»®æƒ³åŒ–ã‚½ãƒ•ãƒˆ

* VMware Player
* VirtualBox

#### Bio-Linux

FastQC, Picardâ†’NGSãƒ‡ãƒ¼ã‚¿ã®ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

Abyss, Velvetâ†’ã‚¢ã‚»ãƒ³ãƒ–ãƒ«

Bowtie2ã€BWAâ†’ãƒãƒƒãƒ”ãƒ³ã‚°

Cufflinksâ†’éºä¼å­æ§‹é€ æ¨å®š

MEMEâ†’ãƒ¢ãƒãƒ¼ãƒ•è§£æ

MAFFT, T-Coffeeâ†’å¤šé‡é…åˆ—ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆ

WebLogoâ†’seaquence logsã®å®Ÿè¡Œ

Cytoscapeâ†’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è§£æ

blast2â†’BLASTå®Ÿè¡Œ

ãƒã‚¤ã‚¯ãƒ­ã‚¢ãƒ¬ã‚¤ãƒ‡ãƒ¼ã‚¿ã¯æ•°å€¤

RNA-seqãƒ‡ãƒ¼ã‚¿ã¯å¡©åŸºé…åˆ—

ReCountã¨ã„ã†DBãŒã„ã„ã‚‰ã—ã„ï¼Ÿ

ArrayExpressã¨ã„ã†å…¬å…±DBãŒã‚ã‚‹ã‚‰ã—ã„ã€‚



DDBJ Read Annotation Pipelineã£ã¦ãªã‚“ãï¼Ÿ



ä¹³é…¸èŒã‚²ãƒãƒ ã¯ã™ã§ã«è§£èª­æ¸ˆã¿ã§ã€Ensembleã¨ã„ã†å…¬å…±DBã‹ã‚‰å–å¾—ã§ãã‚‹ã€‚



## ç¬¬äºŒå›

ä¹³é…¸èŒã®é…åˆ—

```shell
$ wget ftp://ftp.ensemblgenomes.org/pub/bacteria/release-42/fasta/bacteria_15_collection/lactobacillus_casei_12a/dna/Lactobacillus_casei_12a.ASM30956v2.dna.toplevel.fa.gz -O Lactobacillus_toplevel.fa.gz;gunzip Lactobacillus_toplevel.fa.gz 
```

[EnsembleBacteria](https://bacteria.ensembl.org/)

[Ensemble](https://www.ensembl.org/info/about/species.html)

```shell
$ grep -c ">" Lactobacillus_toplevel.fa
```

## ç¬¬ä¸‰å›

### VirtualBox, BioLinuxå‰æ

```shell
$ time wget ftp://ftp.ensemblgenomes.org/
pub/bacteria/release-22/fasta/bacteria_15_collection/
lactobacillus_casei_12a/dna/Lactobacillus_casei_12a.
GCA_000309565.1.22.dna.toplevel.fa.gz
```



ãƒã‚§ãƒƒã‚¯ã‚µãƒ (check sum)â†’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒæä¾›å…ƒã¨åŒä¸€ã§ã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹æ–¹æ³•

`sum`ã‚³ãƒãƒ³ãƒ‰ã§å€¤ãŒå–ã‚Œã‚‹ã€‚

### .gz

#### è§£å‡

```shell
$ gzip -d hoge.fa.gz
```

> `-d`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯decompressã®ç•¥

#### åœ§ç¸®

```shell
$ gzip hoge.fa
```

### è†¨å¤§ãªå®¹é‡ã®é…åˆ—ãƒ•ã‚¡ã‚¤ãƒ«(.fasta, .fastq)ã«å¯¾ã—ã¦

#### ã‚³ãƒ³ãƒ†ã‚£ã‚°æ•°ç¢ºèª

##### FASTAå½¢å¼ã®å ´åˆ

```shell
$ grep -c ">" hoge.fa
```

##### FASTQå½¢å¼ã®å ´åˆ

```shell
$ grep -c "@" hoge.fastq
```

#### ãƒ•ã‚¡ã‚¤ãƒ«å†…ç¢ºèª

`head`,`tail`,`more`,`less`

```shell
$ head -n 5 Lactobacillus_toplevel.fa
$ tail -n 5 Lactobacillus_toplevel.fa
```

> `-n`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯è¡Œæ•°ã‚’æŒ‡å®šã§ãã‚‹ã€‚
>
> ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§10è¡Œã€‚

##### å¿œç”¨

1001 ~ 1010è¡Œã‚ãŸã‚Šã‚’ã¿ã‚‹ã€‚

```shell
$ head -n 1010 Lactobacillus_toplevel.fa | tail -n 10
```

#### è¡Œæ•°ç¢ºèª

```shell
$ wc Lactobacillus_toplevel.fa
48466   48469 2956433 Lactobacillus_toplevel.fa
```

> å‡ºåŠ›ã¯è¡Œæ•°ã€å˜èªæ•°ã€ãƒã‚¤ãƒˆæ•°

#### ãƒ‡ã‚£ã‚¯ã‚¹å®¹é‡ç¢ºèª

`df`,`du`

```shell
$ df /Users
```

`du`ã‚³ãƒãƒ³ãƒ‰ã¯ã‚ã£ã¡ã‚ƒç´°ã‹ã„

#### ã‚µãƒ–ã‚»ãƒƒãƒˆä½œæˆ

å®¹é‡å¤§ãã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã„ããªã‚Šè§£æã«ã‹ã‘ã‚‹ã“ã¨ã¯ãªãã€`head`ã‚³ãƒãƒ³ãƒ‰ã¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’åˆ©ç”¨ã—ã¦ã‚µãƒ–ã‚»ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã€‚

ã“ã®é–“ä½¿ç”¨ã—ãŸã®ã¯`seqtk`ã€‚

`seqkit`ã¨ã„ã†ã®ã‚‚ã‚ã‚Šã€ã“ã¡ã‚‰ã®æ–¹ãŒãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡å°ã•ã„ã‚‰ã—ã„ã€‚

ã‚µãƒ–ã‚»ãƒƒãƒˆã‚’ä½œã‚Šã€ãƒ—ãƒ¬è§£æã‚’è¡Œã†ç›®çš„ã¯ã€å‹•ä½œç¢ºèªã¨ã€æœ¬ç•ªãƒ‡ãƒ¼ã‚¿å®Ÿè¡Œæ™‚ã®å®Ÿè¡Œæ™‚é–“ã®ç›®å®‰ã¨ã™ã‚‹ãŸã‚ã€‚ã‚µãƒ–ã‚»ãƒƒãƒˆã§ç›®å®‰ã‚’å»ºã¦ãŸã‚‰ã€ä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¶ˆã™ã®ãŒä¸€èˆ¬çš„ã‚‰ã—ã„ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤§ãã„ã®ã§ã€‚

ä»ŠçŸ¥ã£ãŸãŒã€`|`ã®ä½¿ç”¨ç›®çš„ã¯ä¸­é–“ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆã‚’é¿ã‘ã‚‹ãŸã‚ã ã£ãŸã®ã‹ã€‚

### å…¬å…±NGSç”¨DB

#### ä¸‰ä»£DB

1. SRA
   * ã‚‚ã£ã¨ã‚‚ãƒ‡ãƒ¼ã‚¿ç·é‡ãŒå¤šã„ã€‚
   * sraå½¢å¼
   * æœ€åˆã®æ¤œç´¢ã«åˆ©ç”¨ã—ã€ç›®çš„ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’åŒå®š

2. [DRA](https://www.ddbj.nig.ac.jp/dra/index.html)
   * FATSTQå½¢å¼ã®bzip2åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

3. [ENA](https://www.ebi.ac.uk/ena/)
   * FATSTQå½¢å¼ã®gzipåœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«
   * ç›®çš„ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å…¨ä½“åƒ(IDã®å¯¾å¿œé–¢ä¿‚)ã‚’ä¿¯ç°

DDBJã«ã‚ˆã‚‹è§£èª¬è¨˜äº‹ã‚’å‚è€ƒã«ã™ã‚‹ã¨ã„ã„ã‚‰ã—ã„ã€‚

#### ä¹³é…¸èŒãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆ

`Lactobacillus casei`ã§æ¤œç´¢ã€‚

ä¾‹ãˆã°ã€ENAã§æ¤œç´¢ã—ã¦ã€Run accessionç•ªå·ãŒ[SRR616269](https://www.ebi.ac.uk/ena/data/view/SRR616269)ã§ã‚ã‚‹ãƒšãƒ¼ã‚¸ã‹ã‚‰ã€Experiment accessionç•ªå·[SRX204227](https://www.ebi.ac.uk/ena/data/view/SRX204227)ã«é£›ã¶ã¨ã€Illumina HiSeq 2000ã§å–å¾—ã—ãŸcDNAã®ãƒšã‚¢ã‚¨ãƒ³ãƒ‰ã®ãƒªãƒ¼ãƒ‰ã ã¨ã‚ã‹ã‚‹ã‚‰ã—ã„ã€‚ãƒšã‚¢ã‚¨ãƒ³ãƒ‰ã¯5'ã¨3'æœ«ç«¯ä¸¡å´ã‹ã‚‰ã‚·ãƒ¼ã‚¯ã‚¨ãƒ³ã‚¹ã™ã‚‹æ–¹æ³•ã§ã‚·ãƒ³ã‚°ãƒ«ã‚¨ãƒ³ãƒ‰ã¯ç‰‡å´ã‹ã‚‰ã‚‰ã—ã„ã€‚ãã®åˆ©ç‚¹ã¨ã‹ã¯ã‚‚ã£ã¨èª¿ã¹ãªã„ã¨ã‚ˆãã‚ã‹ã‚‰ãªã‹ã£ãŸã€‚

ãã—ã¦ENAã§è¦‹ã¤ã‘ãŸ[SRR616268](https://www.ebi.ac.uk/ena/data/view/SRR616268)ã‚’ã‚‚ã¨ã«DRAã§æ¤œç´¢ã—ã€åŒã˜Run accessionã‚’è¦‹ã¤ã‘ã‚‹ã¨[ã“ã®ãƒšãƒ¼ã‚¸](http://ddbj.nig.ac.jp/DRASearch/run?acc=SRR616268)ã«ãŸã©ã‚Šç€ãã€‚ã“ã®ãƒšãƒ¼ã‚¸ã‹ã‚‰ã‚‚ã‚ã‹ã‚‹ã‚ˆã†ã«ã€ã“ã®ç ”ç©¶ã¯SRP017156ã¨ã„ã†IDã§è¡Œã‚ã‚Œã¦ã„ã‚‹ã®ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚’è½ã¨ã™ç”¨ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ä½œæˆã™ã‚‹ã€‚

```shell
$ mkdir srp017156
```

åˆ†å‰²ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å®¹é‡ãŒãã‚Œãã‚Œ7.1GBã¨6.5GBã§å¤§ãã™ãã‚‹ã€‚

```shell
$ wget ftp://ftp.ddbj.nig.ac.jp/ddbj_database/dra/fastq/SRA061/SRA061483/SRX204226/SRR616268.fastq.bz2
$ bzip2 -d SRR616268.fastq.bz2
```

> `bzip2`ã‚³ãƒãƒ³ãƒ‰ã¯`-c`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚Šã€è§£å‡ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã›ãšã«ä¸­ã®æƒ…å ±ã‚’å–ã‚Šå‡ºã™ã“ã¨ã‚‚ã§ãã‚‹ã€‚
>
> ```shell
> $ bzip2 -dc SRR616268.fastq.bz2 | wc
> ```
>
> ã“ã†ã™ã‚‹ã¨ã€è§£å‡ã›ãšã«è¡Œæ•°ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

FASTQå½¢å¼ãƒ•ã‚¡ã‚¤ãƒ«ã¯1ãƒªãƒ¼ãƒ‰ã®æƒ…å ±ã‚’ï¼”è¡Œã§è¨˜è¿°ã™ã‚‹ã¨ã„ã†æ±ºã¾ã‚ŠãŒã‚ã‚‹ã‚‰ã—ã„ã€‚
ã‚ã¨ã€ï¼”è¡Œç›®ã¯ï¼‘æ–‡å­—è¡¨è¨˜ã®ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢ãŒè¡¨è¨˜ã•ã‚Œã¦ã„ã‚‹ã‚‰ã—ã„ã€‚æ­£ç›´ã¿ã¦ã‚‚ã‚ã‹ã‚‰ã‚“ã®ã§è§£é‡ˆã®ãŸã‚ã«èª¿ã¹ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

```shell
$ grep -c "@" SRR616268.fastq
```

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆã¯281964ãƒªãƒ¼ãƒ‰ã‚ã‚‹ã“ã¨ãŒç¢ºã‹ã‚ã‚‰ã‚Œã‚‹ã€‚

ä¸­é–“ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã›ãšã«ã‚µãƒ–ã‚»ãƒƒãƒˆä½œæˆã¾ã§ã—ã¦ã—ã¾ã†æ–¹æ³•ã€‚

```shell
$ bzip2 -dc SRR616268.fastq.bz2| head -n 10000 > subset_1.fastq
```

10000è¡ŒæŠ½å‡ºã—ã¦ã„ã‚‹ã®ã§ã€2500ãƒªãƒ¼ãƒ‰ã«ç›¸å½“ã™ã‚‹ã€‚

## ç¬¬ï¼”å›

### NGSã®æµã‚Œ

1. ãƒ‡ãƒ¼ã‚¿å–å¾—
2. ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã€€â†ä»Šã“ã“
3. ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã€ãƒãƒƒãƒ”ãƒ³ã‚°
4. æ•°å€¤è§£æ

FastQCã§ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è¡Œã†ã€‚



ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—é™¤å»

### ãƒ‡ãƒ¼ã‚¿å–å¾—

å¿…è¦ãªã‚³ãƒãƒ³ãƒ‰ã‚’ã¾ã¨ã‚ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚

```shell
$ touch SRR616268.sh
$ vi SRR616268.sh
```

ãã—ã¦ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ›¸ãè¾¼ã‚€

```shell
$ wget ftp://ftp.ddbj.nig.ac.jp/ddbj_database/dra/fastq/SRA061/SRA061483/SRX204226/SRR616268_1.fastq.bz2; bzip2 -dc SRR616268_1.fastq.bz2| head -n 400000 > subset_1.fastq
$ wget ftp://ftp.ddbj.nig.ac.jp/ddbj_database/dra/fastq/SRA061/SRA061483/SRX204226/SRR616268_2.fastq.bz2; bzip2 -dc SRR616268_2.fastq.bz2| head -n 400000 > subset_2.fastq
```

æ¨©é™ã‚’å¤‰æ›´ã™ã‚‹

```shell
$ chmod 755 SRR616268.sh
-rwxr-xr-x
```

> å®Ÿè¡Œæ¨©é™ã«ã¤ã„ã¦
>
> * Read â†’ï¼”
> * Write â†’ï¼’
> * Execute â†’ï¼‘
>
> ã®åˆè¨ˆå€¤
>
> å·¦ã‹ã‚‰User, Group, Other
>
> å±€æ‰€çš„ã«æ¨©é™ã‚’ã„ã˜ã‚‹å ´åˆã¯ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ãŒæœ‰åŠ¹
>
> ```shell
> $ chmod g+r hoge # ã‚°ãƒ«ãƒ¼ãƒ—ã«èª­ã¿ã¨ã‚Šè¨±å¯
> $ chmod o-w hogeã€€# ãã®ä»–ã®æ›¸ãè¾¼ã¿æ‹’å¦
> ```

ãã—ã¦å®Ÿè¡Œ

```shell
$ time ./SRR616268.sh

```

### ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼ˆQCï¼‰

#### ç›®çš„

* å…¨ä½“çš„ãªç²¾åº¦ãƒã‚§ãƒƒã‚¯
* ã‚¯ã‚ªãƒªãƒ†ã‚£ã®ä½ã„ãƒªãƒ¼ãƒ‰ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
* ãƒªãƒ¼ãƒ‰ã«å«ã¾ã‚Œã‚‹ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—ã‚„ã‚¯ã‚ªãƒªãƒ†ã‚£ã®ä½ã„éƒ¨åˆ†é…åˆ—ã®é™¤å»ï¼ˆãƒˆãƒªãƒŸãƒ³ã‚°ï¼‰

FastQCã‚’ç”¨ã„ã‚‹

#### FastQCã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

##### Linux

```shell
$ wget https://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v0.11.8.zip | unzip ;rm fastqc_v0.11.8.zip
```

##### Bioconda

```shell
$ conda install fastqc
```

ã“ã‚Œã™ã‚‹ã¨ã€`samtools`ãŒå†ã³ä½¿ãˆãªããªã‚‹ã®ã§å›°ã‚‹ã€‚

#### å®Ÿè¡Œ

```shell
$ fastqc hoge.fastq
```

å‡ºåŠ›ã¯htmlãƒ¬ãƒãƒ¼ãƒˆã«ãªã‚‹ã€‚

#### ãƒ¬ãƒãƒ¼ãƒˆã®è¦‹æ–¹

é»„è‰²ã®ç®±ã²ã’å›³ã§ãƒã‚¸ã‚·ãƒ§ãƒ³ã”ã¨ã®ãƒªãƒ¼ãƒ‰ã®ã‚¹ã‚³ã‚¢ãŒåˆ†å¸ƒã•ã‚Œã¦ã„ã‚‹ã€‚ãƒªãƒ¼ãƒ‰ã®ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢ãŒå¹³å‡çš„ã«ã©ã†ãªã£ã¦ã„ã‚‹ã‹ãŒé‡è¦ã€‚ã»ã¨ã‚“ã©ã®ãƒã‚¸ã‚·ãƒ§ãƒ³ã§ã‚¹ã‚³ã‚¢åˆ†å¸ƒãŒ20ä»¥ä¸Šã«ãªã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ã€‚ã‚¹ã‚³ã‚¢20ã¯100å›ä¸­ï¼‘å›ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚‹ç¢ºç‡ã«ç›¸å½“ã™ã‚‹ã‚‰ã—ã„ã€‚

$$
score = -10\log (p_err)
$$
å‰å›ä½œã£ãŸã‚ˆãã‚ã‹ã‚‰ã‚“ãƒ•ã‚¡ã‚¤ãƒ«è¦‹ãŸã‚‰ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢ã‚ã¡ã‚ƒãã¡ã‚ƒæ‚ªã‹ã£ãŸã€‚ã‚ˆãã‚ã‹ã‚‰ã‚“ãŒã€‚

ä»Šå›ã®`subset_1.fastq`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã®çµæœã¯ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢ã¯è‰¯å¥½ã ãŒã€**Overrepresented sequence**ã¤ã¾ã‚Šã€é »å‡ºé…åˆ—ã®ä¸­ã«ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—ãŒï¼“ç¨®é¡è¦‹ã¤ã‹ã£ãŸã€‚

`TruSeq Adapter, Index 3 (100% over 50bp)`ã“ã‚“ãªæ„Ÿã˜ã®åå‰ã§ã€‚

50å¡©åŸºå¯¾ä»¥ä¸Šã§æ§‹æˆã•ã‚Œã‚‹ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—

ã•ã‚‰ã«ã€åŸºç¤è§£æã®æ¬„ã‹ã‚‰ã€107å¡©åŸºå¯¾ã®ãƒªãƒ¼ãƒ‰ã ã¨ã‚ã‹ã‚‹ã€‚

 `TruSeq Adapter, Index 3 (100% over 50bp)`

```shell
$ grep -c "GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGCATCTCGTATGC" subset_1.fastq
294
```

>  fastqcãƒ¬ãƒãƒ¼ãƒˆã§ã¯262ãƒªãƒ¼ãƒ‰

`TruSeq Adapter, Index 2 (100% over 50bp)`

```shell
$ grep -c "GATCGGAAGAGCACACGTCTGAACTCCAGTCACCGATGTATCTCGTATGC" subset_1.fastq
288
```

> fastqcãƒ¬ãƒãƒ¼ãƒˆã§ã¯153ãƒªãƒ¼ãƒ‰

`TruSeq Adapter, Index 2 (100% over 49bp)`

```shell
$ grep -c "AGATCGGAAGAGCACACGTCTGAACTCCAGTCACCGATGTATCTCGTATG" subset_1.fastq
135
```

> fatsqcãƒ¬ãƒãƒ¼ãƒˆã§ã¯127ãƒªãƒ¼ãƒ‰

#### ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—ã®é™¤å»

##### FASTX-toolkitã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

###### Linux

```shell
$ wget https://github.com/agordon/fastx_toolkit/releases/download/0.0.14/fastx_toolkit-0.0.14.tar.bz2 | bzip2 -dc | tar xvf
```

###### Bioconda

```shell
$ conda install fastx_toolkit
```

##### å®Ÿè¡Œ

```shell
$ time fastx_clipper \
-a é…åˆ—\
-i å…¥åŠ›\
-o hoge1.fastq
```

 `TruSeq Adapter, Index 3 (100% over 50bp)`

```shell
$ time fastx_clipper \
-a "GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGCATCTCGTATGC" \
-i subset_1.fastq \
-o hoge1.fastq

fastx_clipper -a "GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGCATCTCGTATGC" -i  -o   21.58s user 0.54s system 93% cpu 23.542 total
```

```shell
$ wc hoge1.fastq
391512  783024 28271228 hoge1.fastq
```

```shell
$ grep -c "@" hoge1.fastq
97878
```

2122ãƒªãƒ¼ãƒ‰ãŒãªããªã£ã¦ã„ã‚‹ã€‚

ï¼‘ãƒªãƒ¼ãƒ‰107bpã§50bpã®é…åˆ—ã‚’å‰Šé™¤ã—ãŸã‹ã‚‰ã€1ãƒªãƒ¼ãƒ‰ã«ä¸€ã¤ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—ãŒå…¥ã£ã¦ã„ã‚Œã°ã€ç·ãƒªãƒ¼ãƒ‰æ•°ã¯å¤‰ã‚ã‚‰ãªã„ã¯ãšã€‚ã™ãªã‚ã¡ã€å…¨ã¦ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—ã§ã‚ã‚‹ãƒªãƒ¼ãƒ‰ãŒå­˜åœ¨ã—ã¦ã„ã‚‹?

```shell
$ fastqc -q hoge1.fastq; o hoge1_fastqc.html
```

æœ€çŸ­ã§5bpã®ãƒªãƒ¼ãƒ‰ãŒã‚ã‚‹ã“ã¨ãŒåˆ¤æ˜ã€‚

```shell
$ fastx_clipper -h
usage: fastx_clipper [-h] [-a ADAPTER] [-D] [-l N] [-n] [-d N] [-c] [-C] [-o] [-v] [-z] [-i INFILE] [-o OUTFILE]
Part of FASTX Toolkit 0.0.14 by A. Gordon (assafgordon@gmail.com)

   [-h]         = This helpful help screen.
   [-a ADAPTER] = ADAPTER string. default is CCTTAAGG (dummy adapter).
   [-l N]       = discard sequences shorter than N nucleotides. default is 5.
   [-d N]       = Keep the adapter and N bases after it.
                  (using '-d 0' is the same as not using '-d' at all. which is the default).
   [-c]         = Discard non-clipped sequences (i.e. - keep only sequences which contained the adapter).
   [-C]         = Discard clipped sequences (i.e. - keep only sequences which did not contained the adapter).
   [-k]         = Report Adapter-Only sequences.
   [-n]         = keep sequences with unknown (N) nucleotides. default is to discard such sequences.
   [-v]         = Verbose - report number of sequences.
                  If [-o] is specified,  report will be printed to STDOUT.
                  If [-o] is not specified (and output goes to STDOUT),
                  report will be printed to STDERR.
   [-z]         = Compress output with GZIP.
   [-D]	 = DEBUG output.
   [-M N]       = require minimum adapter alignment length of N.
                  If less than N nucleotides aligned with the adapter - don't clip it.   [-i INFILE]  = FASTA/Q input file. default is STDIN.
   [-o OUTFILE] = FASTA/Q output file. default is STDOUT.
```

ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã ã‘ã®é…åˆ—ã‚’èª¿ã¹ã‚‹

```shell
$ fastx_clipper \
-k \
-a "GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGCATCTCGTATGC" \
-i subset_1.fastq \
-o hoge2.fastq ; grep -c "@" hoge2.fastq

871
```

-n`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§unknownãƒŒã‚¯ãƒ¬ã‚ªãƒãƒ‰ã‚‚è¡¨ç¤ºã•ã›ã€ã•ã‚‰ã«5bpæœªæº€ã‚‚è¡¨ç¤ºã•ã›ã‚‹ã€‚

```shell
$ fastx_clipper \
-n \
-l 0 \
-a "GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGCATCTCGTATGC" \
-i subset_1.fastq \
-o hoge3.fastq ; grep -c "@" hoge3.fastq

99129
```

ã“ã‚Œã§å…¨ã¦æ´—ãˆãŸã€‚æ”¹ã‚ã¦ã€QCã‚’è¦‹ã¦ã¿ã‚‹ã€‚

```shell
$ fastqc -q hoge3.fastq; o hoge3_fastqc.html
```

Aã—ã‹ãªã„ãƒªãƒ¼ãƒ‰ãŒ194å€‹ã‚‚ã‚ã‚‹ã¨ã‹è¨€ã£ã¦ã‚‹ã€‚

#### æ¤œè¨¼

 `TruSeq Adapter, Index 3 (100% over 50bp)`

fastqcãƒ¬ãƒãƒ¼ãƒˆã§ã¯262ãƒªãƒ¼ãƒ‰

```shell
$ grep -c "GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGCATCTCGTATGC" subset_1.fastq
294
```

```shell
$ grep -c "^GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGCATCTCGTATGC" subset_1.fastq
262
```

æ­£è¦è¡¨ç¾ã§è¡Œé ­ã‹ã‚‰æ¤œç´¢ã™ã‚‹ã¨ã€ãƒ¬ãƒãƒ¼ãƒˆã®æ•°ã¨ä¸€è‡´ã™ã‚‹ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãå‡ºã—ã¦ã¿ã‚‹ã€‚

```shell
$ grep "^GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGCATCTCGTATGC" subset_1.fastq > age.txt
$ less age.txt
```

ãªã‚‹ã»ã©ã€‚ã©ã“ã‹ã«å«ã‚€å ´åˆã¯ã©ã†ã‹ã€‚

```shell
$ grep "GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGCATCTCGTATGC" subset_1.fastq | grep -v "^GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGCATCTCGTATGC" > uge1.txt
```

> `grep`ã®`-v`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯å«ã¾ãªã„ã‚‚ã®ã‚’æŠ½å‡º

```shell
$ less -N uge1.txt
```

> lessèµ·å‹•ä¸­ã¯`/`ã§æ¤œç´¢ã€`n`ã§æ¬¡ã®æ¤œç´¢ã€`N`ã§å‰ã®æ¤œç´¢ã‚’é¸æŠã§ãã‚‹ã€‚
>
> `-N`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯è¡Œç•ªå·ã‚’è¡¨ç¤ºã™ã‚‹ã‚„ã¤ã€‚

`TruSeq Adapter, Index 3 (100% over 50bp)`ã¨ã„ã†ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã¯[ã“ã“](TruSeq Adapter, Index 3 (100% over 50bp))ã«ã‚ã‚‹ã‚ˆã†ã«63bpã®é…åˆ—ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚‹ã€‚ãã‚Œã§ã€ã“ã†ã„ã†å¥´ã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹é…åˆ—ã¨ã„ã†ã‚‰ã—ã„ã€‚

### Python

ä¸»è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

* cutadapt â†’ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—é™¤å»
* HTSeq â†’ãƒãƒƒãƒ—ã•ã‚ŒãŸãƒªãƒ¼ãƒ‰ã®ã‚«ã‚¦ãƒ³ãƒˆ
* PySam â†’HTSeqãŒå†…éƒ¨çš„ã«ä½¿ç”¨
* hgvs â†’ãƒ’ãƒˆã‚²ãƒãƒ ã®å¤šå‹ã‚„å¤‰ç•°ã‚’æ‰±ã†

## ç¬¬ï¼•å›

### FaQCs

ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é™¤å»å…¼ã‚¯ã‚ªãƒªãƒ†ã‚£ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

#### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[GitHub](https://github.com/chienchi/FaQCs)

Linuxã ã¨`git clone`ã—ãŸå¾Œã«`lib`ãƒ•ã‚©ãƒ«ãƒ€ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚Œã°è‰¯ã•ãã†ã€‚

ã“ã‚“ãªã®ã‚‚ã‚ã£ãŸ

[github](https://github.com/LANL-Bioinformatics/FaQCs)

ã‚ˆãã‚ã‹ã‚‰ãªã„

```shell
$ conda install faqcs
```

### ã‚µãƒ–ã‚»ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®åœ§ç¸®

.gzå½¢å¼ã«åœ§ç¸®ã™ã‚‹

```shell
$ gzip subset_1.fastq
```

> è§£å‡ã¯
>
> ```shell
> $ gzip -d subset_1.fastq.gz
> ```
>
> ã‚‚ã—ãã¯
>
> ```shell
> $ gunzip subset_1.fastq.gz
> ```
>
> 

### ã‚²ãƒãƒ ã‚¢ã‚»ãƒ³ãƒ–ãƒªå‘¨è¾º

NGSãƒ‡ãƒ¼ã‚¿ã«å«ã¾ã‚Œã¦ã„ã‚‹ã€ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚„ãƒ—ãƒ©ã‚¤ãƒãƒ¼é…åˆ—ãªã©ã®è§£æã‚µãƒ³ãƒ—ãƒ«ç”±æ¥ä»¥å¤–ã®å¡©åŸºé…åˆ—ã‚’é™¤å»ã™ã‚‹ã€‚

ã‚·ãƒ¼ã‚±ãƒ³ã‚µãƒ¼ã«ã‹ã‘ã‚‹éš›ã«ã€PCRã§å¢—å¹…ã™ã‚‹ã‚‚ã®ã¨æ€ã‚ã‚Œã‚‹ãŒã€ãã®æ™‚ã«ãƒ—ãƒ©ã‚¤ãƒãƒ¼ã‚’æ··ãœã‚‹ã®ã§ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®çµæœã«ã‚‚ãƒ—ãƒ©ã‚¤ãƒãƒ¼ãŒæ··å…¥ã™ã‚‹ã‚‚ã®ã¨æ€ã‚ã‚Œã‚‹ã€‚ãã®é™¤å»ã€‚

ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—ã¨ã¯ã€NGSã«ãŠã„ã¦ã€ã‚µãƒ³ãƒ—ãƒ«ã‚’èª¿æ•´ã™ã‚‹éš›ã«ã€æœ€åˆã«DNAã‚’æ–­ç‰‡åŒ–ã™ã‚‹ãŒã€ãã®æ–­ç‰‡åŒ–ã•ã‚ŒãŸé…åˆ—ã®ä¸¡æœ«ç«¯ã«ãã£ã¤ã‘ã‚‹ï¼ˆãƒ©ã‚¤ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰é…åˆ—ã€‚ãã—ã¦ã€ãƒ–ãƒªãƒƒã‚¸PCRãªã©ã®æ–¹æ³•ã§å¢—å¹…ã™ã‚‹ã€‚

ãƒ—ãƒ©ã‚¤ãƒãƒ¼ã¯ã€ã™ã§ã«ã‚ã‚‹é…åˆ—ã«ã‚¢ãƒ‹ãƒ¼ãƒªãƒ³ã‚°ã•ã›ã€æŒŸã¿è¾¼ã¾ã‚ŒãŸé ˜åŸŸã‚’å¢—å¹…ã•ã›ã‚‹ã®ã«ä½¿ã†ãŒã€ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—ã¯ã€ãƒ©ã‚¤ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã•ã›ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€å…ƒã®é…åˆ—ã‹ã‚‰ãƒ­ã‚¹ï¼ŸãŒç™ºç”Ÿã—ãªã„ã€ã¨ã„ã†ã“ã¨ã ã¨æ€ã†ã€‚ãã‚Œã ã‘ã˜ã‚ƒãªãã€ãƒ—ãƒ©ã‚¤ãƒãƒ¼ã¯ã™ã§ã«é…åˆ—ãŒã‚ã‹ã£ã¦ã„ãªã„ã¨ã€ã‚¢ãƒ‹ãƒ¼ãƒªãƒ³ã‚°ã§ããªã„ã‘ã©ã€ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—ãªã‚‰OKã¨ã„ã†ã“ã¨ã‹ã€‚

[å‚è€ƒ](https://www.cosmobio.co.jp/support/technology/a/next-generation-sequencing-introduction-apb.asp)

ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚¨ãƒ©ãƒ¼ã‚’å«ã‚€ãƒªãƒ¼ãƒ‰ã®é™¤å»ã®ã²ã¨ã¤ã«*k*-merå‡ºç¾é »åº¦ã«åŸºã¥ããƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãŒã‚ã‚‹ã‚‰ã—ã„ã€‚ãã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯Quakeã¨ã„ã†ã®ãŒåˆå‡ºã‚‰ã—ã„ã€‚

#### ã‚«ãƒãƒ¬ãƒƒã‚¸

ã‚«ãƒãƒ¬ãƒƒã‚¸ã¨ã¯æ­£è§£ã¨ãªã‚‹ï¼Ÿãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹é…åˆ—ã®ãƒ‡ãƒ¼ã‚¿é‡ã«å¯¾ã—ã¦ã€ãã®ä½•å€é‡ã®ãƒªãƒ¼ãƒ‰ã‚’èª­ã¾ãªã„ã¨ã„ã‘ãªã„ã‹ã‚’ç¤ºã™ã€‚

å˜ç´”ã«è€ƒãˆã¦ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒå°‘ãªã„ã»ã©ã«ã€ä¸€ã¤ã®ãƒªãƒ¼ãƒ‰ãŒé•·ãã€ãŸãã•ã‚“èª­ã‚€å¿…è¦ãŒãªã„ã¨ã„ã†ã“ã¨ã«ãªã‚‹ã¨æ€ã‚ã‚Œã‚‹ã€‚

ç´„ï¼“GBã‹ã‚‰ãªã‚‹ãƒ’ãƒˆã‚²ãƒãƒ é…åˆ—æ±ºå®šæ™‚ï¼ˆãƒ’ãƒˆã‚²ãƒãƒ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‹ã£ãŸãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹é…åˆ—ï¼‰ã«ã€ãã®10å€ç¨‹åº¦ï¼ˆç´„30GBï¼‰èª­ã‚“ã§ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã•ã‚ŒãŸã‚‰ã—ã„ã€‚

ãƒªãƒ¼ãƒ‰é•·ãŒ100bpæœªæº€ã ã¨100Xãã‚‰ã„èª­ã‚€å¿…è¦ãŒã‚ã‚‹ã€‚

ã‚²ãƒãƒ ã®å ´åˆã¯ã€ã©ã®é ˜åŸŸã§ã‚‚æ¦‚ã­ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒä¸€å®šã—ã¦ã„ã‚‹ã€‚

#### *k*-mer

ãƒªãƒ¼ãƒ‰ã®é•·ã•ã‚ˆã‚Šã‚‚çŸ­ã„ä»»æ„ã®é•·ã•*k*ã®é€£ç¶šå¡©åŸºã®ã“ã¨ã€‚

ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚¨ãƒ©ãƒ¼ã‚’å«ã‚€*k*-merã¯æƒ³å®šã‚«ãƒãƒ¬ãƒƒã‚¸ã‚ˆã‚Šã‚‚éå¸¸ã«å°‘ãªã„å‡ºç¾å›æ•°ã¨ãªã‚‹ã€‚ä¾‹ãˆã°ã€ãƒªãƒ¼ãƒ‰é•·ãŒ107bpã§ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒ100Xãã‚‰ã„ã ã¨ã—ãŸæ™‚ã«ã€63bpã®ã‚¨ãƒ©ãƒ¼é…åˆ—ã¯...?ã„ã‚„ã€ã‚ˆãã‚ã‹ã‚‰ãªã„ã€‚

ã¨ã«ã‹ãã€*k*-merã¯å‡ºç¾é »åº¦ãŒä½ãã€ãã®ã‚¨ãƒ©ãƒ¼é…åˆ—ã‚’å–ã‚Šé™¤ãã“ã¨ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã§ãã‚‹ã€‚

#### LOOC260

* PacBio RS II
  * å¹³å‡4kbpé•·ã®163,376ãƒªãƒ¼ãƒ‰
  * HGAPã§ã‚¢ã‚»ãƒ³ãƒ–ãƒ«
  * ï¼—ã‚³ãƒ³ãƒ†ã‚£ã‚°ã‚’å–å¾—
* Illumina MiSeq
  * ãƒšã‚¢ã‚¨ãƒ³ãƒ‰ã€250bp
  * Platanusã§ã‚¢ã‚»ãƒ³ãƒ–ãƒ«
  * 53ã‚³ãƒ³ãƒ†ã‚£ã‚°å–å¾—

ã“ã‚Œã‚‰ã‹ã‚‰å®Œå…¨ãªã‚²ãƒãƒ é…åˆ—ã‚’å–å¾—

ãªã‚“ã ã‹ã‚ˆãã‚ã‹ã‚‰ã‚“ãŒã€IGV(Integrative Genoics Viewer)ã¨ã„ã†ViewerãŒã‚ˆãä½¿ã‚ã‚Œã¦ã„ã‚‹ã‚‰ã—ã„ã€‚

### FaQCsã«ã‚ˆã‚‹QC

ãƒˆãƒªãƒŸãƒ³ã‚°ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯

* ãƒšã‚¢ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ¼ã‚¿
* è¤‡æ•°ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—ã®åŒæ™‚é™¤å»
* åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œ

ãŒã§ãã¦ã„ã‚‹ã‚‰ã—ã„ã€‚

ãªã‚“ã¨ã€FaQCsã¯`--adapter`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€Illuminaã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚„ãƒ—ãƒ©ã‚¤ãƒãƒ¼ã‚’è‡ªå‹•é™¤å»ã—ã¦ãã‚Œã‚‹ã‚‰ã—ã„ã€‚

ç¢ºèªã¯ã€å‡ºåŠ›ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’fastqcã«ã‹ã‘ã‚Œã°ã„ã„ã€‚

å®Ÿè¡Œã—ã¦ã¿ã‚‹

```shell
$ time FaQCs --adapter \
-p å…¥åŠ›1 å…¥åŠ›2 \
-d å‡ºåŠ›ã€€# ãƒ•ã‚©ãƒ«ãƒ€ã§æŒ‡å®šã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã¾ã¨ã‚ã‚‰ã‚Œã‚‹ã€‚
```

```shell
$ time FaQCs --adapter -p subset_1.fastq.gz subset_2.fastq.gz -d result

FaQCs --adapter -p subset_1.fastq.gz subset_2.fastq.gz -d result  9.95s user 0.34s system 76% cpu 13.402 total
```

ãªãœã‹`\`ä½¿ã†ã¨ã†ã¾ãå®Ÿè¡Œã•ã‚Œãªã„ã®ã§æ³¨æ„

```shell
$ fastqc -q QC.1.trimmed.fastq; o QC.1.trimmed_fastqc.html;
$ fastqc -q QC.2.trimmed.fastq; o QC.2.trimmed_fastqc.html;
```

ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼é…åˆ—ã¨ã€ãƒ—ãƒ©ã‚¤ãƒãƒ¼ãŒå‰Šé™¤ã•ã‚Œã¦ã„ã‚‹ã®ãŒç¢ºèªã§ãã‚‹ã€‚

### ã‚¢ã‚»ãƒ³ãƒ–ãƒª

ãƒªãƒ¼ãƒ‰ã‚’ã¤ãªãåˆã‚ã›ã¦ã€å…ƒã®ã‚²ãƒãƒ é…åˆ—ã‚’å†æ§‹ç¯‰ã™ã‚‹ã“ã¨ã€‚ã“ã‚Œã‚’è¡Œã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã¨å‘¼ã¶ã€‚

#### *de novo* assembly

ãƒªãƒ¼ãƒ‰ã®ã®ã¿ã‚’å…¥åŠ›ã¨ã—ã¦ã€ã¤ã¾ã‚Šã€ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹é…åˆ—ã‚’ç”¨ã„ãªã„ã§ã‚¢ã‚»ãƒ³ãƒ–ãƒªã™ã‚‹ã“ã¨ã€‚

#### ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ¼ãƒ ã‚¢ã‚»ãƒ³ãƒ–ãƒª

ã‚¢ã‚»ãƒ³ãƒ–ãƒ«å¯¾è±¡ãŒã‚²ãƒãƒ ğŸ§¬ã§ã¯ãªãè§£æã‚µãƒ³ãƒ—ãƒ«ä¸­ã§ç™ºç¾ã—ã¦ã„ã‚‹å…¨è»¢å†™ç‰©ã®å ´åˆ

ä¾‹ãˆã°ã€RNA-seqãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’å…¥åŠ›ã¨ã—ã¦1ã‹ã‚‰ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã™ã‚‹å ´åˆã¯ã€*de novo* transcriptome assemblyã¨å‘¼ã°ã‚Œã‚‹ã€‚

åˆæœŸã®ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ¼ãƒ ç”¨ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã¯ã€ã‚²ãƒãƒ ç”¨ã‚’å†…éƒ¨çš„ã«ç”¨ã„ã¦ã„ãŸã‚‰ã—ã„ã€‚

ã‚¢ã‚»ãƒ³ãƒ–ãƒªå¾Œã¯å¾—ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚£ã‚°ã®ä¼¼ãŸã‚ˆã†ãªé…åˆ—ã®é™¤å»ã€é‡è¤‡ã®é™¤å»ã§ã€ãã®ãŸã‚ã«ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ãŒå¿…è¦ã«ãªã‚‹ã€‚

ã“ã®é‡è¤‡ã®å‡ºç¾é »åº¦ã¯*k*-merã®*k*å€¤ã«ã‚ˆã£ã¦åˆ¶å¾¡ã•ã‚Œã¦ã„ã¦ã€ã“ã®å€¤ãŒå¤§ãããªã‚Œã°å¤§ãããªã‚‹ã»ã©ã€ã¤ã¾ã‚Šã‚¨ãƒ©ãƒ¼ã‚’å«ã‚€é…åˆ—ãŒé•·ã„ã¨ãã€å¾—ã‚‰ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚£ã‚°ã¯é•·ããªã‚Šã€ã“ã†ç™ºè¨€ã®ã‚‚ã®ã«åã‚‹ã€‚é€†ã«ã€ä½ããªã‚Œã°ã€ã™ãªã‚ã¡ã€ã‚¨ãƒ©ãƒ¼é…åˆ—ã‚’çŸ­ãæ„ŸçŸ¥ã™ã‚‹ã‚ˆã†ãªè¨­å®šã§ã‚ã‚Œã°ã€ä½ç™ºç¾è»¢å†™ç‰©ã‚’æ‹¾ã„ä¸Šã’ã‚‰ã‚Œã‚‹ãŒã€ã‚³ãƒ³ãƒ†ã‚£ã‚°ã¯çŸ­ããªã‚Šã€ä¼¼ãŸé…åˆ—ã‹ã‚‰ãªã‚‹ã‚³ãƒ³ãƒ†ã‚£ã‚°ãŒå¤šãå¾—ã‚‰ã‚Œã‚‹å‚¾å‘ã«ã‚ã‚‹ã€‚

ãã®ãŸã‚ã€è¤‡æ•°ã®*k*ã‚’ç”¨ã„ã¦ç‹¬ç«‹ã«ã‚²ãƒãƒ ç”¨ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã‚’å®Ÿè¡Œã—ã€ã§ãã‚‹ã ã‘å¤šãã®è»¢å†™ç‰©ã‚’å¾—ã‚‹ã“ã¨ã‚’ä¸»çœ¼ã«ç½®ã„ã¦ã„ãŸã‚‰ã—ã„ã€‚

ãªãŠã€ãƒ‘ãƒªãƒ³ãƒ‰ãƒ­ãƒ¼ãƒ ã¨ã„ã†ã®ã‚’é¿ã‘ã‚‹ãŸã‚ã«ã€*k*å€¤ã¯å¥‡æ•°ã‚’ç”¨ã„ã‚‹ã‚ˆã†ã ã€‚

ã—ã‹ã—ã€ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ¼ãƒ å°‚ç”¨ã¨ã—ã¦ãƒ‡ã‚¶ã‚¤ãƒ³ã•ã‚ŒãŸTrinityã¨ã„ã†ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã§ã¯*k*=25ã¨ã„ã†å˜ä¸€ã®å€¤ã®ã¿ã§å¹…åºƒã„ç¯„å›²ã®ç™ºç¾ãƒ¬ãƒ™ãƒ«ã‹ã‚‰ãªã‚‹è»¢å†™ç‰©é…åˆ—ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã«æˆåŠŸã—ãŸã‚‰ã—ã„ã€‚

#### reference-based assembly

ã‚²ãƒãƒ é…åˆ—ãªã©ã‚’ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¨ã—ã¦ç”¨ã„ã‚‹ã‚¢ã‚»ãƒ³ãƒ–ãƒªæ–¹æ³•ã€‚
ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹é…åˆ—ã«RNA-seqãƒªãƒ¼ãƒ‰ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã“ã¨ã§ã€ãƒãƒƒãƒ—ã•ã‚ŒãŸé ˜åŸŸãŒRNAãŒè»¢å†™ã•ã‚ŒãŸé ˜åŸŸã¨ã—ã¦ã‚ã‹ã‚‹ã€‚

éå»ã«è»¢å†™ãŒå ±å‘Šã•ã‚Œã¦ã„ãªã„é ˜åŸŸã«ã€ãƒãƒƒãƒ—ã•ã‚ŒãŸå ´åˆã€å˜ç´”ã«è€ƒãˆã¦ã€æ–°ã—ã„è»¢å†™é ˜åŸŸãŒè¦‹ã¤ã‹ã£ãŸã¨ã„ã†ç™ºè¦‹ã ã¨è€ƒãˆã‚‹ãŒã€ãã‚Œã¯ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒéå¸¸ã«é«˜ã„æ™‚ã€ä¿¡é ¼åº¦ãŒé«˜ã„ã€‚ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒå¤§ãã„ã¨ã„ã†ã“ã¨ã¯ã€å¿…è¦ãªãƒªãƒ¼ãƒ‰æ•°ãŒå¤šã„ã¨ã„ã†ã“ã¨ã§ã€ãã‚Œã‚’æº€ãŸã—ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã«ãªã‚‹ã‹ã‚‰ã‹ãªï¼Ÿ
é€†ã«ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒä½ã„ã¨ã€å½é™½æ€§ã‹ã‚‚ã—ã‚Œãªã„ã€‚

### Rockhopper2

ãƒã‚¯ãƒ†ãƒªã‚¢å°‚ç”¨ã®*de novo*ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã€‚ä»Šå›ã¯ãƒ‘ã‚¹ã€‚

## ç¬¬ï¼–å›

### ãƒ‡ãƒ¼ã‚¿å–å¾—

[ENA](https://www.ebi.ac.uk/ena/data/view/DRR024501)â†’å¤–è¦³ã‚’çœºã‚ã€290ä¸‡ãƒªãƒ¼ãƒ‰ã ã¨ã‚ã‹ã‚‹ã€‚
æ¬¡ã«DRA](http://ddbj.nig.ac.jp/DRASearch/)ã“ã“ã§DLã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã™ã‚‹ã€‚[ã“ã“](ftp://ftp.ddbj.nig.ac.jp/ddbj_database/dra/fastq/DRA002/DRA002643/DRX022186)ã«ç›®çš„ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç™ºè¦‹ã—ãŸãŒã€è¨ˆ1GBã‚‚ã®ãƒ‡ãƒ¼ã‚¿ã¯ã„ã‚‰ãªã„ã®ã§ã€ä¸¡æ–¹ã¨ã‚‚æœ€åˆã®30ä¸‡ãƒªãƒ¼ãƒ‰ã®ã¿ã‚’é¸æŠã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚

FASTQãƒ•ã‚¡ã‚¤ãƒ«ã¯ï¼‘ãƒªãƒ¼ãƒ‰ï¼”è¡Œã ã‹ã‚‰ã€è¨ˆ120ä¸‡è¡ŒæŠ½å‡ºã™ã‚Œã°ã„ã„ã€‚

```shell
$ wget ftp://ftp.ddbj.nig.ac.jp/ddbj_database/dra/fastq/DRA002/DRA002643/DRX022186/DRR024501_1.fastq.bz2 -O -| bzip2 -dc -|head -n 1200000 | gzip -c > DRR024501sub_1.fastq.gz
```

> `-O`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å¼•æ•°ã‚’`-`ã«ã™ã‚‹ã¨ã€æ¨™æº–å‡ºåŠ›ã¨ã—ã¦å—ã‘å–ã‚Œã‚‹ã‚‰ã—ã„ã€‚
> æœ€å¾Œã¯æ¨™æº–å‡ºåŠ›ã‚’`gzip`ã‚³ãƒãƒ³ãƒ‰ã§åœ§ç¸®ã—ãŸæ¨™æº–å‡ºåŠ›ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ãå‡ºã—ã¦ã„ã‚‹ã€‚
>
> ãƒ‘ã‚¤ãƒ—ã§æ¸¡ã›ã‚‹ã®ã¯**æ¨™æº–å‡ºåŠ›**ã¨ã„ã†ç‚¹ã«æ³¨æ„ã€‚
> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¸¡ã™ã“ã¨ã¯ã§ããªã„ã€‚

```shell
$ time wget ftp://ftp.ddbj.nig.ac.jp/ddbj_database/dra/fastq/DRA002/DRA002643/DRX022186/DRR024501_2.fastq.bz2 -O -| bzip2 -dc -|head -n 1200000 | gzip -c > DRR024501sub_2.fastq.gz

DRR024501_2.fastq.b  10%[=>                  ]  50.60M  1.58MB/s    in 32s     

DRR024501_2.fastq.bz2: Broken pipe, closing control connection.
wget  -O -  0.06s user 0.22s system 0% cpu 32.373 total
bzip2 -dc -  17.18s user 0.24s system 53% cpu 32.370 total
head -n 1200000  0.28s user 0.11s system 1% cpu 32.367 total
gzip -c > DRR024501sub_2.fastq.gz  28.26s user 0.37s system 88% cpu 32.386 total
```

æœ€åˆã®10%ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ä¸­æ–­ã—ã¦ã‚µãƒ–ã‚»ãƒƒãƒˆã‚’ä½œæˆã—ã¦ãã‚Œã‚‹ã€‚

ãªãœã‹ãƒªãƒ¼ãƒ‰æ•°ã¯æ„å›³ã—ãŸ30ä¸‡ãƒªãƒ¼ãƒ‰ã«ãªã£ã¦ã„ãªã„ã€‚

```shell
$ gzip -dc DRR024501sub_1.fastq.gz | grep -c "@"
415768

$ gzip -dc DRR024501sub_2.fastq.gz | grep -c "@"
465208
```

10ä¸‡ã»ã©å¤šããƒªãƒ¼ãƒ‰ã‚’æŠ½å‡ºã—ã¦ã„ã‚‹æ¨¡æ§˜ã€‚ãªãœï¼Ÿ

å…ˆé ­ã«@ã‚’å«ã‚€ã‚‚ã®ã ã‘ã‚’`grep`ã—ã¦ã¿ã‚‹ã¨ã¡ã‚ƒã‚“ã¨30ä¸‡ãƒªãƒ¼ãƒ‰ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚

ãã†ã˜ã‚ƒãªã„ã‚„ã¤ã¯ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§è¦‹ã‚‰ã‚Œã‚‹ã€‚

```shell
$ gzip -dc DRR024501sub_1.fastq.gz| grep "@" | grep -v "^@" | less -N
```

> ```shell
> $ sw_vers
> ProductName:    Mac OS X
> ProductVersion: 10.14.3
> BuildVersion:   18D109
> ```

### QC

FastQCã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã€æ¨™æº–å…¥åŠ›ã™ã‚‹å ´åˆã¯å¼•æ•°ã«ãƒ•ã‚¡ã‚¤ãƒ«åã§ã¯ãªã`stdin`ã‚’ä¸ãˆãªã„ã¨æ¨™æº–å…¥åŠ›ã‚’å—ã‘å–ã‚Œãªã„ã€‚

è©³ç´°ã¯[ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆ](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/RELEASE_NOTES.txt)v0.11.1ã®(8)å‚ç…§

```shell
$ gzip -dc DRR024501sub_1.fastq.gz | fastqc stdin
```

ã“ã®å ´åˆã€`stdin_fastqc.html`ã¨`stdin_fastqc.zip`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã‚‹ã€‚ãƒ•ã‚©ãƒ«ãƒ€ã«åˆ†ã‘ã¦ç®¡ç†ã™ã‚‹ã€‚

```shell
$ mkdir DRR024501sub_1_QC
$ mv stdin_fastqc.html stdin_fastqc.zip DRR024501sub_1_QC
```

ã¾ã¨ã‚ã‚‹ã¨ã“ã‚“ãªæ„Ÿã˜

```shell
$ time gzip -dc DRR024501sub_2.fastq.gz | fastqc stdin;mkdir DRR024501sub_2_QC;mv stdin_fastqc.html stdin_fastqc.zip DRR024501sub_2_QC;cd DRR024501sub_2_QC;o stdin_fastqc.html

Started analysis of stdin
Approx 100% complete for stdin
Analysis complete for stdin
gzip -dc DRR024501sub_2.fastq.gz  0.89s user 0.15s system 14% cpu 7.112 total
fastqc stdin  15.41s user 1.08s system 122% cpu 13.463 total
```

FastQCãƒ¬ãƒãƒ¼ãƒˆã‚’è¦‹ã¦ã¿ã‚‹ã¨ãƒªãƒ¼ãƒ‰ã‚ãŸã‚Š251bpã«ãªã£ã¦ã„ã‚‹ãŒã€æœ€å¾Œã®ä¸€å¡©åŸºã¯é©åˆ‡ã«QCã§ããªã„ãŸã‚ãƒˆãƒªãƒ ã—ãŸæ–¹ãŒã„ã„ã‚‰ã—ã„ã€‚

[å‚è€ƒ](http://seqanswers.com/forums/archive/index.php/t-39107.html)

ãã®ãŸã‚ã€è«–æ–‡ã§ã¯250bpã§è§£æã—ã¦ã„ã‚‹æ¨¡æ§˜ã€‚

ãªãŠã€ãƒªãƒ¼ãƒ‰ã®å ´æ‰€ã”ã¨ã®Qualityã®ã‚°ãƒ©ãƒ•ã¯ã€`--nogroup`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç„¡ã—ã«ã—ã¦ãŠãã¨ã€æ¨ªå¹…ã«åã¾ã‚‹ã‚ˆã†ã«50bpã‚ˆã‚Šãƒªãƒ¼ãƒ‰ãŒé•·ã„æ™‚ã€10å¡©åŸºç›®ä»¥é™ã¯ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã•ã‚Œã¦ãã®å¹³å‡ã§è¡¨ç¤ºã•ã‚Œã¦ã—ã¾ã†ã€‚ä»Šå›ã®é•·ã•ã ã¨ã€ï¼•å¡©åŸºã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã•ã‚Œã¦ã„ã‚‹ã®ãŒã‚ã‹ã‚‹ã€‚ã“ã‚Œã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ãªã„`--nogroup`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã¦ã€å†åº¦å®Ÿè¡Œã—ã¦ã¿ã‚‹ã€‚

```shell
$ gzip -dc DRR024501sub_1.fastq.gz | fastqc stdin --nogroup;mkdir DRR024501sub_1_QC_nogroup; mv stdin_fastqc.html stdin_fastqc.zip DRR024501sub_1_QC_nogroup; cd DRR024501sub_1_QC_nogroup;o stdin_fastqc.html; cd ../
$ gzip -dc DRR024501sub_2.fastq.gz | fastqc stdin --nogroup;mkdir DRR024501sub_2_QC_nogroup; mv stdin_fastqc.html stdin_fastqc.zip DRR024501sub_2_QC_nogroup; cd DRR024501sub_2_QC_nogroup;o stdin_fastqc.html; cd ../
```





### ç‹¬ã‚Šè¨€

æ°—ã¥ã„ãŸã‘ã©ã€ä»Šã¾ã§ä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯æ¨™æº–å‡ºåŠ›å—ã‘å…¥ã‚Œã‚‰ã‚Œã‚‹æ„Ÿã˜ã§ã¯ãªã‹ã£ãŸã€‚

```shell
$ python hoge.py fuga.txt
```

ã£ã¦ã„ã†å½¢å¼ã§ã—ã‹å—ã‘å…¥ã‚Œã‚‰ã‚Œãªã„é¢¨ã«æ›¸ã„ã¦ã„ãŸã£ã¦ã“ã¨ã¯ã€æ¨™æº–å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã¦ãªã„ã‹ã‚‰ã€ãƒ‘ã‚¤ãƒ—ã§ç¹‹ã’ãªã„ã—ã€ç”¨ã‚’ãªã•ãªã„æ°—ãŒã™ã‚‹ã€‚

```python
# æ¨™æº–å‡ºåŠ›ã§ã‚‚ã€ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã‚‚å—ã‘å…¥ã‚Œã‚‰ã‚Œã‚‹æ›¸ãæ–¹ã£ã¦ã©ã‚“ãªæ„Ÿã˜ï¼Ÿ
import argparse

parser = argparse.ArgumentParser('hoge')
parser.add_argument(
	'hoge_file',
	type=argparse.FileType('r')
)
args = parser.parse_args()
f = args.hoge_file
```
ã“ã‚“ãªæ„Ÿã˜ã§`argparse`ä½¿ãˆã°ã„ã„ã‚“ã˜ã‚ƒãªã„ã™ã‹ã€‚





### ã‚¢ã‚»ãƒ³ãƒ–ãƒª

#### Velvet

